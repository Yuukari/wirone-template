# wirone-template
Стартовый шаблон для использования wirone - микро-фреймворка для работы с умным домом Яндекса.

Данный шаблон содержит базовую реализацию сервера, включая готовые обработчики OAuth авторизации, связь с базой данных MySQL, и описание трех устройств для умного дома.

## Требования к запуску
Для успешного развертывания сервера необходимо следующее:

* Node.JS
* Сервер баз данных MySQL
* Файлы SSL сертификата для домена, который будет предоставлять доступ к серверу (сам сертификат, цепочка сертификации и приватный ключ)
> Если у вас нет возможности использовать SSL сертификат напрямую, вы можете запустить сервер без использования HTTPS, настроив безопасное подключение через reverse-proxy (например, используя nginx)

## Первичная настройка

1. Импортируйте базу данных из файла [wirone-template.sql](https://github.com/Yuukari/wirone-template/blob/main/wirone-template.sql)
2. Настройте подключение к базе данных в конфигурации, в файле config.js
3. Скопируйте файлы SSL сертификата в папку */static/ssl*, и укажите соответстующие пути к файлам в конфигурации
4. Создайте новый навык с типом "Умный дом" в [платформе диалогов Яндекса](https://dialogs.yandex.ru/developer)
5. Укажите в качестве URL для Backend'а ваш домен, и настройте связку аккаунтов следующим образом:

![](https://github.com/Yuukari/wirone-template/raw/main/readme/account-linking.png)
> Данные для OAuth авторизации можно изменить в конфигурации wirone, в файле index.js 
6. Запустите сервер, выполнив команды: 

   ```
   > npm install
   > npm start
   ```

## Авторизация
При связке аккаунтов в режиме тестирования навыка или в приложении Яндекса, вы перейдете на страницу авторизации Wirone. В данном примере уже созданы два тестовых пользователя, которых можно использовать для авторизации:
```
Логин: WironeUser1
Пароль: 12345678
```
или
```
Логин: WironeUser2
Пароль: 12345678
```

После успешной авторизации вам будут доступны устройства пользователя:

![](https://github.com/Yuukari/wirone-template/raw/main/readme/devices-added.png) ![](https://github.com/Yuukari/wirone-template/raw/main/readme/devices-connected.png)
